\documentclass[12pt,fleqn]{article}\usepackage{../common}
\begin{document}


\begin{minted}[fontsize=\footnotesize]{python}
%load_ext autoreload
%autoreload 2
import pandas as pd, celebpred
clfs, ocols, conf = celebpred.test()
df = pd.read_csv("./data/celeb_astro_mbti.csv",sep=';')
print 'Avg AUC', np.array(list(conf.values())).mean()
\end{minted}

\begin{verbatim}
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
Si AUC : 0.571429
Ti AUC : 0.555556
Ne AUC : 0.600000
Fe AUC : 0.625000
Te AUC : 0.500000
Ni AUC : 0.285714
Se AUC : 0.875000
Fi AUC : 0.785714
Avg AUC 0.599801587302
\end{verbatim}


\begin{minted}[fontsize=\footnotesize]{python}
import pandas as pd, mineprep
df_t = pd.DataFrame(index=[0], columns=['mbti', 'name', 'occup', 'bday'])
df_t.loc[0,'mbti'] = 'xxx'
#df_t.loc[0,'bday'] = '24/04/1973'
df_t.loc[0,'bday'] = '5/10/1945'
#df_t.loc[0,'bday'] = '24/04/1973'

df2_t = mineprep.astro_enrich(df_t)

for col in df.columns: 
   if col not in df2_t.columns: df2_t[col] = np.nan
df2_t = df2_t.drop(celebpred.cols,axis=1)
# the order of columns must be exactly the same as 
# the order in the training set
df2_t = df2_t[ocols] 

XX = df2_t.fillna(0)

for clf in clfs: 
    res = clfs[clf].predict_proba(XX)[0]
    print clf, res*conf[clf]
\end{minted}

\begin{verbatim}
Ni [ 0.11646854  0.16924574]
Ne [ 0.58456923  0.01543077]
Si [ 0.41284791  0.15858066]
Fe [ 0.28586079  0.33913921]
Ti [ 0.54384725  0.01170831]
Fi [ 0.56530519  0.2204091 ]
Te [ 0.26607004  0.23392996]
Se [ 0.76352517  0.11147483]
\end{verbatim}


\end{document}
