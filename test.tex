\documentclass[12pt,fleqn]{article}\usepackage{../common}
\begin{document}


\begin{minted}[fontsize=\footnotesize]{python}
%load_ext autoreload
%autoreload 2
import pandas as pd, celebpred
clfs, ocols = celebpred.test()
df = pd.read_csv("./data/celeb_astro_mbti.csv",sep=';')
\end{minted}

\begin{verbatim}
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
Si AUC : 0.500000
Ti AUC : 0.611111
Ne AUC : 0.550000
Fe AUC : 0.250000
Te AUC : 0.388889
Ni AUC : 0.214286
Se AUC : 1.000000
Fi AUC : 0.571429
Avg AUC 0.510714285714
\end{verbatim}


\begin{minted}[fontsize=\footnotesize]{python}
import pandas as pd, mineprep
df_t = pd.DataFrame(index=[0], columns=['mbti', 'name', 'occup', 'bday'])
df_t.loc[0,'mbti'] = 'xxx'
df_t.loc[0,'bday'] = '24/04/1973'

df2_t = mineprep.astro_enrich(df_t)

for col in df.columns: 
   if col not in df2_t.columns: df2_t[col] = np.nan
df2_t = df2_t.drop(celebpred.cols,axis=1)
# the order of columns must be exactly the same as 
# the order in the training set
df2_t = df2_t[ocols] 

XX = df2_t.fillna(0)

for clf in clfs: 
    res = clfs[clf].predict_proba(XX)[0]
    #res = clfs[clf].predict(XX)
    print clf, res
\end{minted}

\begin{verbatim}
Ni [ 0.61553335  0.38446665]
Ne [ 0.95228454  0.04771546]
Si [ 0.92013087  0.07986913]
Fe [ 0.68337896  0.31662104]
Ti [ 0.89697112  0.10302888]
Fi [ 0.57598652  0.42401348]
Te [ 0.77421626  0.22578374]
Se [ 0.55197173  0.44802827]
\end{verbatim}


\end{document}
