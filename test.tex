\documentclass[12pt,fleqn]{article}\usepackage{../common}
\begin{document}

\begin{minted}[fontsize=\footnotesize]{python}
import pandas as pd
import numpy as np
df = pd.read_csv('data/celeb_astro_mbti.csv',sep=';')
df['label'] = (df['mbti1']=='Ti').astype(float)
df = df.drop(['mbti','mbti1','mbti2'],axis=1)
lewi = map(lambda x: 'lewi'+str(x),range(278))
df['diversity'] = df[lewi].sum(axis=1)
df['total'] = 1
\end{minted}


\begin{minted}[fontsize=\footnotesize]{python}
import statsmodels.api as sm
import statsmodels.formula.api as smf
#s = "label ~ C(spiller) + C(chinese) + C(M2) + diversity "
s = "label ~ C(spiller) + C(chinese) + C(M2) "
mdlm = smf.logit(s, data=df)
mdlmf = mdlm.fit()
print(mdlmf.summary())
\end{minted}

\begin{verbatim}
Optimization terminated successfully.
         Current function value: 0.537016
         Iterations 6
                           Logit Regression Results                           
==============================================================================
Dep. Variable:                  label   No. Observations:                  426
Model:                          Logit   Df Residuals:                      393
Method:                           MLE   Df Model:                           32
Date:                Sat, 11 Apr 2015   Pseudo R-squ.:                 0.07549
Time:                        23:18:17   Log-Likelihood:                -228.77
converged:                       True   LL-Null:                       -247.45
                                        LLR p-value:                    0.2364
=============================================================================================
                                coef    std err          z      P>|z|      [95.0% Conf. Int.]
---------------------------------------------------------------------------------------------
Intercept                    -2.7813      1.117     -2.490      0.013        -4.970    -0.592
C(spiller)[T.Aries]          -0.0458      0.651     -0.070      0.944        -1.321     1.230
C(spiller)[T.Cancer]         -0.3375      0.625     -0.540      0.589        -1.562     0.887
C(spiller)[T.Capricorn]       0.1456      0.627      0.232      0.816        -1.084     1.375
C(spiller)[T.Gemini]         -0.2089      0.653     -0.320      0.749        -1.488     1.070
C(spiller)[T.Leo]            -0.4466      0.654     -0.683      0.495        -1.729     0.836
C(spiller)[T.Libra]           0.8416      0.592      1.422      0.155        -0.318     2.001
C(spiller)[T.Pisces]         -0.2818      0.652     -0.432      0.666        -1.559     0.996
C(spiller)[T.Sagittarius]    -0.5878      0.631     -0.932      0.351        -1.824     0.648
C(spiller)[T.Scorpio]         0.1779      0.653      0.272      0.785        -1.102     1.458
C(spiller)[T.Taurus]         -0.3861      0.610     -0.633      0.527        -1.581     0.809
C(spiller)[T.Virgo]          -0.4126      0.688     -0.600      0.549        -1.761     0.936
C(chinese)[T.Dragon]          1.4536      0.629      2.312      0.021         0.221     2.686
C(chinese)[T.Horse]           1.3312      0.672      1.981      0.048         0.014     2.648
C(chinese)[T.Monkey]          1.3336      0.676      1.971      0.049         0.008     2.659
C(chinese)[T.Ox]              1.5770      0.635      2.483      0.013         0.332     2.822
C(chinese)[T.Pig]             1.9593      0.627      3.126      0.002         0.731     3.188
C(chinese)[T.Rabbit]          0.7893      0.671      1.177      0.239        -0.525     2.104
C(chinese)[T.Rat]             0.8421      0.749      1.125      0.261        -0.625     2.309
C(chinese)[T.Rooster]         0.6867      0.724      0.949      0.343        -0.732     2.105
C(chinese)[T.Sheep]           0.7016      0.690      1.017      0.309        -0.650     2.053
C(chinese)[T.Snake]           0.7171      0.643      1.115      0.265        -0.543     1.977
C(chinese)[T.Tiger]           1.6340      0.626      2.608      0.009         0.406     2.862
C(M2)[T.3]                    0.1581      0.997      0.159      0.874        -1.797     2.113
C(M2)[T.4]                    1.2530      0.933      1.343      0.179        -0.575     3.081
C(M2)[T.5]                    0.7194      0.949      0.758      0.448        -1.140     2.579
C(M2)[T.6]                    0.6787      0.955      0.711      0.477        -1.193     2.551
C(M2)[T.7]                    0.6631      0.923      0.718      0.472        -1.146     2.472
C(M2)[T.8]                    0.3646      0.964      0.378      0.705        -1.526     2.255
C(M2)[T.9]                    1.5795      0.964      1.638      0.101        -0.310     3.469
C(M2)[T.10]                   0.3969      0.940      0.422      0.673        -1.446     2.240
C(M2)[T.11]                   0.9494      0.950      0.999      0.318        -0.913     2.811
C(M2)[T.12]                   0.0939      1.521      0.062      0.951        -2.887     3.075
=============================================================================================
\end{verbatim}

\begin{minted}[fontsize=\footnotesize]{python}
print df.groupby(['chinese','spiller']).sum()[['label','total']]
\end{minted}

\begin{verbatim}
                     label  total
chinese spiller                  
Dog     Aquarius         1      5
        Cancer           0      5
        Gemini           2      9
        Libra            2      9
        Pisces           1      6
        Scorpio          0      6
        Taurus           0      1
        Virgo            0      1
Dragon  Aquarius         2      4
        Cancer           2      5
        Gemini           0      2
        Libra            3      9
        Pisces           1      4
        Scorpio          1      3
        Taurus           2      6
Horse   Aquarius         0      1
        Aries            0      3
        Capricorn        1      9
        Leo              1      2
        Libra            1      1
        Sagittarius      1      5
        Taurus           4      6
        Virgo            2      7
Monkey  Aries            4     13
        Cancer           2      3
        Leo              0      5
        Pisces           3      5
        Sagittarius      0      6
        Scorpio          1      3
Ox      Aries            3      6
...                    ...    ...
Rooster Cancer           1      4
        Gemini           0      1
        Leo              0      5
        Pisces           2     10
        Sagittarius      0      2
        Scorpio          2      5
Sheep   Aries            0      3
        Cancer           0      2
        Capricorn        1      4
        Leo              2     14
        Pisces           0      3
        Sagittarius      2      4
        Scorpio          1      2
        Taurus           1      6
        Virgo            0      4
Snake   Aquarius         1      5
        Capricorn        0      2
        Gemini           2      7
        Libra            4     11
        Taurus           0      5
        Virgo            1      6
Tiger   Aquarius         0      1
        Aries            1      4
        Cancer           3     10
        Leo              3      5
        Libra            1      2
        Pisces           1      6
        Sagittarius      5     13
        Scorpio          1      2
        Taurus           0      1

[90 rows x 2 columns]
\end{verbatim}


\end{document}
